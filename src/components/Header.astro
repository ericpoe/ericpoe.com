---
import { getCollection } from 'astro:content';
import { siteMetadata } from '../data/siteMetadata';
import { slugify } from '../utils/slugify';
import { formatTitleMla } from '../utils/titleCase';
import ThemeToggle from './ThemeToggle.astro';

const posts = await getCollection('blog');
const categories = Array.from(
  new Set(
    posts
      .flatMap((post) => post.data.categories ?? [])
      .filter(Boolean)
  )
).sort((a, b) => a.localeCompare(b));
---

<nav class="bg-indigo-900 m-0 py-5 px-6 w-full">
  <div class="flex items-center justify-between gap-6 flex-wrap">
    <a href="/" class="!text-gray-100 no-underline text-4xl md:text-5xl">
      {siteMetadata.title}
    </a>
    <div class="flex items-center gap-6 text-base md:text-3xl text-gray-100 dark:text-gray-100 flex-wrap justify-center flex-1">
      {
        categories.map((cat) => {
          const slug = slugify(cat);
          return (
            <a class="no-underline hover:underline !text-gray-100 !dark:text-gray-100" href={`/category/${slug}/`}>
              {formatTitleMla(cat)}
            </a>
          );
        })
      }
    </div>
    <ThemeToggle />
  </div>
</nav>
